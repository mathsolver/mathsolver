<?php

use MathSolver\Runner;
use MathSolver\Utilities\StringToTreeConverter;

it('simplifies products and adds like terms', function (string $input, string $expected) {
    $tree = StringToTreeConverter::run($input);
    $result = Runner::run($tree)['result'];
    $expected = StringToTreeConverter::run($expected);
    expect($result)->toEqual($expected);
})->with([
    ['p + p + p + p', '4p'],
    ['x + x', '2x'],
    ['a + a + a + a + a + a + a + a', '8a'],
    ['r + r + r + r + r + r', '6r'],
    ['5a * 9b', '45ab'],
    ['25a * -4b', '-100ab'],
    ['-8b * 4a', '-32ab'],
    ['-3p * -q', '3pq'],
    ['6x * -5', '-30x'],
    ['-p * -a', 'ap'],
    ['0.2a * c * 5b', 'abc'],
    ['-8x * -y * 3z', '24xyz'],
    ['-a * -b * -1', '-ab'],
    ['5y * -3x * -z', '15xyz'],
    ['18y * 0 * -2x', '0'],
    ['-0.5ac * -8b', '4abc'],
    ['15a * 3a', '45a^2'],
    ['15a * 3b', '45ab'],
    ['-1/3x * -1/2x', 'x^2/6'],
    ['-2/3 * -3/4y', 'y/2'],
    ['1/3x * 2/3y * -3/5x', '-2x^2y / 15'],
    ['2/3x * 1/2y * 3z', 'xyz'],
    ['6a + 7a', '13a'],
    ['2c + 3c', '5c'],
    ['1096x + 4x', '1100x'],
    ['15y + y', '16y'],
    ['154x + 46x', '200x'],
    ['1.5q + 0.5q', '2q'],
    ['2ab + 8ab', '10ab'],
    ['4.5p + p', '5.5p'],
    ['c + 13c', '14c'],
    ['3a + 10a', '13a'],
    ['3a + 10b', '3a + 10b'],
    ['b + 8b', '9b'],
    ['3x + 8', '3x + 8'],
    ['2ac + 6ac', '8ac'],
    ['2ac + 8ad', '2ac + 8ad'],
    ['a + 3/2a', '5a / 2'],
    ['1/2a + 1/3b', 'frac[3a + 2b, 6]'],
    ['7/2a + 3/2a', '5a'],
    ['5a + 2b + 3a + 4b', '8a + 6b'],
    ['8a + 6 + 2a + 9', '10a + 15'],
    ['6a + 14a + 3b', '20a + 3b'],
    ['2ab + 4b + 6ab + 8b', '12b + 8ab'],
    ['3ab + 2bc + 8bc + ab', '4ab + 10bc'],
    ['6a + 5b + 6b', '6a + 11b'],
    ['6a + 8a + 5a', '19a'],
    ['6a * 8a', '48a^2'],
    ['6a + 8a + a', '15a'],
    ['6a * 8b', '48ab'],
    ['3x + 4x + x + 2y', '8x + 2y'],
    ['-3x * -4y * -x', '-12x^2y'],
    ['3x * -2y', '-6xy'],
    ['3x + y + 2y + y', '3x + 4y'],
    ['p + p + q', '2p + q'],
    ['p + 5 + q + 8', 'p + q + 13'],
    ['-5/3p * -2/5p', '2p^2 / 3'],
    ['6p * -2/3 * 3q', '-12pq'],
    ['5a + 3b + 7/3c + 6a + 7b + 17/2c', 'frac[66a + 60b + 65c, 6]'],
    ['3ab + 5bc + 7ac + 8ab + 9ac + 10bc', '11ab + 15bc + 16ac'],
    ['7pq + 8p + 9q + 6pq + pq + p + q', '9p + 10q + 14pq'],
    ['3ab * -5 * -5/2ce * 8d', '300abcde'],
    ['12abc * 5 def * 0 * 30gh', '0'],
    ['12abc * 5bd * 2 * 30ae', '3600a^2b^2cde'],
    ['3a - 5a', '-2a'],
    ['-3a - 5a', '-8a'],
    ['-3a + 5a', '2a'],
    ['6b + -2b', '4b'],
    ['-6b +- 2b', '-8b'],
    ['-6b - -2b', '-4b'],
    ['5x - 4x', 'x'],
    ['-5x + 5x', '0'],
    ['4x - 5x', '-x'],
    ['6p - 12p', '-6p'],
    ['-2a - 8a', '-10a'],
    ['0.6x + 1.4x', '2x'],
    ['5ab - 12ab', '-7ab'],
    ['-3pq - 4pr', '-3pq - 4pr'],
    ['-12ac + ac', '-11ac'],
    ['6a - 7a', '-a'],
    ['3bc - 2bc', 'bc'],
    ['-5ac + 5bc', '-5ac + 5bc'],
    ['2x - 3x - 4y', '-x - 4y'],
    ['2x - 3y - 4y', '2x - 7y'],
    ['-3a - 4a + 2b', '-7a + 2b'],
    ['7p - 4q - 3q', '7p - 7q'],
    ['-3t - 4t - 5t', '-12t'],
    ['2a - 3b + 5a - 2b', '7a - 5b'],
    ['-3a - b + 2b - a', '-4a + b'],
    ['3a + 2b + 8a - 2b', '11a'],
    ['5x + 4y - x - 5y', '4x - y'],
    ['-3x + 8y - 8y + 3x', '0'],
    ['x - y + x + y', '2x'],
    ['2x - 3 + 5x - 2', '7x - 5'],
    ['-x + y + x - y', '0'],
    ['13/4x - 1 + 8 - 1/2x', 'frac[22x + 56, 8]'],
    ['-a - b - a + b', '-2a'],
    ['8a + 4 - 8a + 2', '6'],
    ['-2/3a - ab - 3ab + 1/5a', 'frac[-7a - 60ab, 15]'],
    ['2 * 3a + 6 * 5a', '36a'],
    ['3 * 4n - 2n * 7', '-2n'],
    ['5p * 3q - 2 * 4pq', '7pq'],
    ['3x * 5y + 1/2x * 4y', '17xy'],
    ['4a * 5b - 4b * 6a', '-4ab'],
    ['20xy + 6x * 1/3y', '22xy'],
]);
